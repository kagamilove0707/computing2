# 常微分方程式

未知関数とその導関数によって記述された方程式を **微分方程式** と呼びます。

微分方程式の中でも、一変数のみを含む微分方程式を **常微分方程式** と呼びます。

$$
\frac{d}{dt} x(t) = f(t, x(t))
$$

以下は最も簡単な常微分方程式の例です。

$$
\frac{dx}{dt} = -x
$$

この常微分方程式は以下のような一般解を持ちます。

$$
x = a e^{-t}
$$

# 常微分方程式の初期値問題

以下の常微分方程式について考えます。

$$
\frac{d}{dt} x(t) = f(t, x(t))
$$

初期条件 $$x(t_0) = x_0$$ が与えられたときの$$x(T)$$ の値を求めたいとしましょう。

具体的に、前述の常微分方程式で考えてみます。

$$
\frac{d}{dt} x(t) = -x
$$

初期値 $$x(0) = 1$$ に対して $$x(1)$$ を求めてみましょう。

この常微分方程式の一般解は次式でした。

$$
x(t) = a e^{-t}
$$

初期値の条件を満たすのは $$a = 1$$ のときなので、$$x(1)$$ は以下のようになります。

$$
x(1) = \frac{1}{e}
$$

このように、常微分方程式と初期値が与えられ、任意の $$t$$ の時点での値を求める問題を常微分方程式の **初期値問題** と呼びます。
常微分方程式の一般解が得られている場合は容易に初期値問題の解を得ることができます。
一般解を用いた初期値問題の解を **厳密解** あるいは **解析解** と呼びます。

世の中に常微分方程式で表される現象は数多く存在し、初期値問題の工学的応用は数多く存在します。
しかしながら、それらの一般解を求めることは必ずしも容易ではありません。
そこで、数値計算によって近似的にその解を得ることを考えてみましょう。

# 2 階常微分方程式

2 階微分を含んだ常微分方程式を **2 階常微分方程式** と呼びます。
次のような形の 2 階常微分方程式を考えてみましょう。

$$
\frac{d^2}{dt^2} x(t) + \alpha \frac{d}{dt} x(t) + \beta x(t) = 0
$$

このように右辺が 0 の 2 階常微分方程式を特に **2 階同次常微分方程式** と呼びます。

次式を特性方程式とします。

$$
\lambda^2 + \alpha \lambda + \beta = 0
$$

詳細な議論は省略しますが、特性方程式の解を $$\lambda_1, \lambda_2$$ 、$$C_1, C_2$$ を積分定数とすると、2 階同次常微分方程式の一般解は次のようになることが知られています。

$$
x(t) = C_1 e^{\lambda_1 t} + C_2 e^{\lambda_2 t}
$$

具体的に次のような 2 階常微分方程式を考えてみます。

$$
\frac{d^2}{dt^2} x(t) = -x(t)
$$

特性方程式は、

$$
\lambda^2 + 1 = 0
$$

であり、特性方程式の解は $$\lambda = \pm i$$（$$i^2 = -1$$）です。

一般解は次のように表されます。

$$
x(t) = C_1 e^{-i t} + C_2 e^{i t}
$$

これを Euler の公式 $$e^{i t} = \cos(t) + i \sin(t)$$ を用いて整理すると次のようになります。。

$$
x(t) = (C_1 + C_2) \cos(t) - (C_1 - C_2) i \sin(t)
$$

次のような初期値が与えられたときの初期値問題を考えてみましょう。

$$
\begin{aligned}
x(0) &= 1 \\
\frac{d}{dt} x(0) &= 0
\end{aligned}
$$

はじめに、$$C_1, C_2$$ を求めなければなりません。

以下の連立方程式より、

$$
\begin{aligned}
x(0) &= (C_1 + C_2) \cos(0) - (C_1 - C_2) i \sin(0) = 1 \\
\frac{d}{dt} x(0) &= -(C_1 + C_2) \sin(0) - (C_1 - C_2) i \cos(0) = 0
\end{aligned}
$$

$$C_1 = C_2 = \frac{1}{2}$$ であることがわかります。

そのため、この初期値問題の解析解は、

$$
x(t) = \cos(t)
$$

となります。

# 連立微分方程式

二つの変数が相互に影響しあっている現象について考えてみましょう。
そのような現象は例えば次のような **連立微分方程式** として表されます。

$$
\begin{aligned}
\frac{d}{dt} x(t) &= \alpha x(t) + \beta y(t) \\
\frac{d}{dt} y(t) &= \gamma x(t) + \delta y(t)
\end{aligned}
$$

最初はこの一般解を考えてみましょう。

ここから $$t$$ と $$x(t)$$ だけの微分方程式を導きます。

$$
\begin{aligned}
\frac{d^2}{dt^2} x(t) &= \alpha \frac{d}{dt} x(t) + \beta \frac{d}{dt} y(t) \\
\frac{d}{dt} y(t) &= \frac{1}{\beta} \left( \frac{d^2}{dt^2} x(t) - \alpha \frac{d}{dt} x(t) \right)
\end{aligned}
$$

と、

$$
y(t) = \frac{1}{\beta} \left( \frac{d}{dt} x(t) - \alpha x(t) \right)
$$

より、

$$
\frac{1}{\beta} \left( \frac{d^2}{dt^2} x(t) - \alpha \frac{d}{dt} x(t) \right) = \gamma x(t) + \frac{\delta}{\beta} \left( \frac{d}{dt} x(t) - \alpha x(t) \right)
$$

となります。

これを整理すると、

$$
\frac{d^2}{dt^2} x(t) - (\alpha + \delta) \frac{d}{dt} x(t) + (\alpha \delta - \beta \gamma) x(t) = 0
$$

となり、2 階同次常微分方程式が得られました。

$$y(t)$$ についても同様に、

$$
\frac{d^2}{dt^2} y(t) - (\alpha + \delta) \frac{d}{dt} y(t) + (\alpha \delta - \beta \gamma) y(t) = 0
$$

となります。

2 階同次常微分方程式の一般解を用いてこれらの連立方程式の一般解を得ることができます。

具体的に次のような初期値問題を考えてみましょう。

$$
\begin{aligned}
\frac{d}{dt} x(t) &= y(t) \\
\frac{d}{dt} y(t) &= -x(t) \\
x(0) &= 1 \\
y(0) &= 0
\end{aligned}
$$

$$x(t)$$ と $$y(t)$$ それぞれについて以下のような 2 階常微分方程式を得ることができます。

$$
\begin{aligned}
\frac{d^2}{dt^2} x(t) + x(t) &= 0 \\
\frac{d^2}{dt^2} y(t) + y(t) &= 0
\end{aligned}
$$

また、

$$
\begin{aligned}
\frac{d}{dt} x(0) &= 0 \\
\frac{d}{dt} y(0) &= -1
\end{aligned}
$$

です。

2 階同次常微分方程式の解析解と同様の計算を行うことで、

$$
\begin{aligned}
x(t) &= \cos(t) \\
y(t) &= -\sin(t)
\end{aligned}
$$

となります。
