# 10 進固定小数点数

シミュレーションやコンピュータグラフィックスでは、その目的に応じてある程度の誤差は許容することができます。
一方で、例えば金銭を扱うシステムでは誤差が生じると困ります。
これまでみてきたように、浮動小数点数では 0.1 という極めて身近な小数でも誤差を生じました。

以下は 1.0 - 0.9 を計算するプログラムです。

```java
float a = 1.0;
float b = 0.9;
println("a - b = " + (a - b));
```

実行結果は以下のように誤差を生じます。

```console
a - b = 0.100000024
```

コンピュータで、誤差が出ないように小数を扱うことはできるのでしょうか？
コンピュータのプロセッサが採用している浮動小数点数を使うのではなく、実数の計算の仕組みをプログラム上で実現することでそれは可能です。
Processing では、10 進固定小数点数を表す Java の `BigDecimal` クラスを利用できます。

`BigDecimal` を用いた 1.0 - 0.9 の計算は以下のようになります。

```java
import java.math.BigDecimal;

BigDecimal a = new BigDecimal("1");
BigDecimal b = new BigDecimal("0.9");
println("a - b = " + a.subtract(b));
```

実行結果は以下のようになります。

```console
a - b = 0.1
```

誤差のない計算結果 0.1 を得ることができました。

一方で、BigDecimal にもメリット・デメリットがあります。
`float` に対する `BigDecimal` のメリットは以下の通りです。

- 浮動小数点数に由来する演算誤差が生じない
- 桁数に制限がない

一方で以下のデメリットがあります。

- 演算が低速
- Processing（Java）においては組み込みの演算子が使用できず、演算のためのメソッドを使う必要がある
